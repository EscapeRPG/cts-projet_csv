{% extends 'base.html.twig' %}

{% block title %}Votre nouveau mot de passe{% endblock %}

{% block stylesheets %}
    <link rel="stylesheet" href="{{ asset('styles/forms/forms.css') }}">
{% endblock %}

{% block body %}
    <h1>Réinitialisez votre mot de passe</h1>

    {% set errors = [] %}

    {# Erreurs globales #}
    {% for error in resetForm.vars.errors %}
        {% set errors = errors|merge([error.message]) %}
    {% endfor %}

    {# Erreurs des champs (y compris RepeatedType) #}
    {% for child in resetForm %}
        {% for error in child.vars.errors %}
            {% set errors = errors|merge([error.message]) %}
        {% endfor %}

        {# Si le champ a lui-même des enfants (RepeatedType) #}
        {% if child is iterable %}
            {% for sub in child %}
                {% for error in sub.vars.errors %}
                    {% set errors = errors|merge([error.message]) %}
                {% endfor %}
            {% endfor %}
        {% endif %}
    {% endfor %}

    {% if errors|length > 0 %}
        <div class="alert alert-danger">
            <ul>
                {% for error in errors %}
                    <li>- {{ error }}</li>
                {% endfor %}
            </ul>
        </div>
    {% endif %}

    <div class="form-wrapper">
        {{ form_start(resetForm) }}

        <div>
            {{ form_label(resetForm.plainPassword.first) }}
            {{ form_widget(resetForm.plainPassword.first) }}
        </div>

        <div>
            <small>{{ form_help(resetForm.plainPassword.first) }}</small>
        </div>

        <div>
            {{ form_label(resetForm.plainPassword.second) }}
            {{ form_widget(resetForm.plainPassword.second) }}
        </div>

        <button type="submit">Définir le mot de passe</button>

        {{ form_end(resetForm) }}
    </div>
{% endblock %}
